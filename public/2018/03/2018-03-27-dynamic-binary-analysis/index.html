<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' disqus.com disquscdn.com *.disqus.com *.disquscdn.com; form-action 'self' https://syndication.twitter.com/ https://platform.twitter.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com; frame-src 'self' https://cse.google.com https://player.vimeo.com www.youtube.com www.youtube-nocookie.com https://platform.twitter.com https://syndication.twitter.com  jsfiddle.net www.instagram.com https://kuula.co https://www.slideshare.net https://www.google.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com; img-src 'self' https://jeremylikness.visualstudio.com *.gstatic.com *.amazon-adsystem.com https://www.googleapis.com https://images-na.ssl-images-amazon.com https://platform.twitter.com *.twimg.com https://syndication.twitter.com data: https://files.kuula.io disqus.com disquscdn.com *.disqus.com *.disquscdn.com; object-src 'none'; style-src 'self' 'unsafe-inline' https://use.fontawesome.com https://fonts.googleapis.com https://www.google.com https://platform.twitter.com *.twimg.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com; script-src 'self' 'unsafe-inline' https://platform.twitter.com https://static.cloudflareinsights.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com; prefetch-src 'self' 'unsafe-inline' https://platform.twitter.com https://static.cloudflareinsights.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com; connect-src 'self' 'unsafe-inline' https://platform.twitter.com https://static.cloudflareinsights.com disqus.com disquscdn.com *.disqus.com *.disquscdn.com;">
<meta name=keywords content="[Infosec Blue Team Linux]">
<meta name=robots content="noodp">
<meta http-equiv=x-ua-compatible content="IE=edge, chrome=1">
<title>Getting started with Dynamic Binary Analysis - n0p Blog</title><meta name=Description content="n0p Blog"><meta property="og:title" content="Getting started with Dynamic Binary Analysis">
<meta property="og:description" content="What, Why, and Where? What is it exactly? Dynamic Binary Analysis (DBA) is a technique to analyze the behavior of a binary by somehow running it and watch its behavior. Obviously it&rsquo;s the opposite of Static Binary Analysis in which you disassemble a piece of code and draw the graph of the entire program to see what it does.
Why not Static? well, it&rsquo;s actually better if you have a small binary or a binary written in a friendly programming language.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.n0p.me/2018/03/2018-03-27-dynamic-binary-analysis/"><meta property="og:image" content="https://blog.n0p.me/author.jpg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-03-27T18:18:00+00:00">
<meta property="article:modified_time" content="2018-03-27T18:18:00+00:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.n0p.me/author.jpg">
<meta name=twitter:title content="Getting started with Dynamic Binary Analysis">
<meta name=twitter:description content="What, Why, and Where? What is it exactly? Dynamic Binary Analysis (DBA) is a technique to analyze the behavior of a binary by somehow running it and watch its behavior. Obviously it&rsquo;s the opposite of Static Binary Analysis in which you disassemble a piece of code and draw the graph of the entire program to see what it does.
Why not Static? well, it&rsquo;s actually better if you have a small binary or a binary written in a friendly programming language.">
<meta name=application-name content="n0p Blog">
<meta name=apple-mobile-web-app-title content="n0p Blog"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.n0p.me/2018/03/2018-03-27-dynamic-binary-analysis/><link rel=prev href=https://blog.n0p.me/2018/02/2018-02-20-portsharding/><link rel=next href=https://blog.n0p.me/2018/05/2018-05-21-winbox-bug-dissection/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Getting started with Dynamic Binary Analysis","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.n0p.me\/2018\/03\/2018-03-27-dynamic-binary-analysis\/"},"genre":"posts","keywords":"linux, reverse, binary analysis","wordcount":809,"url":"https:\/\/blog.n0p.me\/2018\/03\/2018-03-27-dynamic-binary-analysis\/","datePublished":"2018-03-27T18:18:00+00:00","dateModified":"2018-03-27T18:18:00+00:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"Ali Mosajjal"},"author":{"@type":"Person","name":"Ali Mosajjal"},"description":""}</script></head>
<body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark')&&document.body.setAttribute('theme','dark')</script>
<div id=mask></div><div class=wrapper><header class=desktop id=header-desktop>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="n0p Blog">n0p Blog</a>
</div>
<div class=menu>
<div class=menu-inner><a class=menu-item href=/posts> Posts </a><a class=menu-item href=/tags> Tags </a><a class=menu-item href=/categories> Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-desktop>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a>
</div>
</div>
</div>
</header><header class=mobile id=header-mobile>
<div class=header-container>
<div class=header-wrapper>
<div class=header-title>
<a href=/ title="n0p Blog">n0p Blog</a>
</div>
<div class=menu-toggle id=menu-toggle-mobile>
<span></span><span></span><span></span>
</div>
</div>
<div class=menu id=menu-mobile><div class=search-wrapper>
<div class="search mobile" id=search-mobile>
<input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search>
<i class="fas fa-search fa-fw"></i>
</a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear>
<i class="fas fa-times-circle fa-fw"></i>
</a>
<span class="search-button search-loading" id=search-loading-mobile>
<i class="fas fa-spinner fa-fw fa-spin"></i>
</span>
</div>
<a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>
Cancel
</a>
</div><a class=menu-item href=/posts title>Posts</a><a class=menu-item href=/tags title>Tags</a><a class=menu-item href=/categories title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i>
</a></div>
</div>
</header>
<div class="search-dropdown desktop">
<div id=search-dropdown-desktop></div>
</div>
<div class="search-dropdown mobile">
<div id=search-dropdown-mobile></div>
</div>
<main class=main>
<div class=container><div class=toc id=toc-auto>
<h2 class=toc-title>Contents</h2>
<div class=toc-content id=toc-content-auto></div>
</div><article class="page single"><h1 class="single-title animated flipInX">Getting started with Dynamic Binary Analysis</h1><div class=post-meta>
<div class=post-meta-line><span class=post-author><a href=/ title=Author rel=" author" class=author><i class="fas fa-user-circle fa-fw"></i>Ali Mosajjal</a></span>&nbsp;<span class=post-category>included in <a href=/categories/reverse-engineering/><i class="far fa-folder fa-fw"></i>Reverse Engineering</a></span></div>
<div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2018-03-27>2018-03-27</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;809 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div>
</div><div class="details toc" id=toc-static kept>
<div class="details-summary toc-title">
<span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span>
</div>
<div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents>
<ul>
<li><a href=#what-is-it-exactly>What is it exactly?</a></li>
<li><a href=#why-not-static>Why not Static?</a></li>
</ul>
<ul>
<li><a href=#dba-or-dbi>DBA or DBI?</a></li>
<li><a href=#instrumentation-is-cool>Instrumentation is cool</a>
<ul>
<li><a href=#pin>Pin</a></li>
<li><a href=#pinatrace>pinatrace</a></li>
</ul>
</li>
</ul>
</nav></div>
</div><div class=content id=content><p><img class=lazyload src=/svg/loading.min.svg data-src=https://memegenerator.net/img/instances/58266813/everybodys-out-partying-and-im-sitting-here-reverse-engineering.jpg data-srcset="https://memegenerator.net/img/instances/58266813/everybodys-out-partying-and-im-sitting-here-reverse-engineering.jpg, https://memegenerator.net/img/instances/58266813/everybodys-out-partying-and-im-sitting-here-reverse-engineering.jpg 1.5x, https://memegenerator.net/img/instances/58266813/everybodys-out-partying-and-im-sitting-here-reverse-engineering.jpg 2x" data-sizes=auto alt=https://memegenerator.net/img/instances/58266813/everybodys-out-partying-and-im-sitting-here-reverse-engineering.jpg title=image></p>
<h1 id=what-why-and-where>What, Why, and Where?</h1>
<h2 id=what-is-it-exactly>What is it exactly?</h2>
<p>Dynamic Binary Analysis (DBA) is a technique to analyze the behavior of a binary by somehow running it and watch its behavior. Obviously it&rsquo;s the opposite of Static Binary Analysis in which you disassemble a piece of code and draw the graph of the entire program to see what it does.</p>
<h2 id=why-not-static>Why not Static?</h2>
<p>well, it&rsquo;s actually better if you have a small binary or a binary written in a friendly programming language. But when your binary gets big enough, or you use C++, Rust or Go as your language of choice, it becomes increasingly difficult to see what the binary is doing.</p>
<h1 id=ok-lets-go-through-it>OK let&rsquo;s go through it</h1>
<h2 id=dba-or-dbi>DBA or DBI?</h2>
<p>As I mentioned, DBA is a technique. For example, there are some DBA tools to profile your memory and visualize it so you can go back and forth with your execution and see the memory mapping in each step. As you can already imagine, this is a very useful way of analyzing the behavior of a binary and see exactly what&rsquo;s going on inside it without reading so much assembly.</p>
<p>But DBA itself relies on a framework that makes it possible. Those underlying framework are called DBI or Dynamic Binary Instrumentation</p>
<h2 id=instrumentation-is-cool>Instrumentation is cool</h2>
<p>Dynamic Binary Instrumentaion is a technique to analyze and modify the behavior of a binary program by injecting arbitrary code at arbitrary places while it is executing.</p>
<p>It basically gives you an API to &ldquo;hook&rdquo; wherever you want in the binary while it&rsquo;s running. Then you can do whatever you want with the binary at that moment. One of my favorite tools of DBI is Intel&rsquo;s Pin. Its API allows injecting C/C++ arbitrary code. Cool, right?</p>
<p>Alternatives to Pin:</p>
<ul>
<li>DynamoRIO (Win, Linux, Mac)</li>
</ul>
<p><a href=http://www.dynamorio.org/ target=_blank rel="noopener noreffer">DynamoRIO</a> is a runtime code manipulation system that supports code transformations on any part of a program, while it executes. DynamoRIO exports an interface for building dynamic tools for a wide variety of uses: program analysis and understanding, profiling, instrumentation, optimization, translation, etc. Unlike many dynamic tool systems, DynamoRIO is not limited to insertion of callouts/trampolines and allows arbitrary modifications to application instructions via a powerful IA-32/AMD64/ARM/AArch64 instruction manipulation library. DynamoRIO provides efficient, transparent, and comprehensive manipulation of unmodified applications running on stock operating systems (Windows, Linux, or Android) and commodity IA-32, AMD64, ARM, and AArch64 hardware. Mac OSX support is in progress.</p>
<ul>
<li>Valgrind (Linux)</li>
</ul>
<p><a href=http://valgrind.org/ target=_blank rel="noopener noreffer">Valgrind</a> is an instrumentation framework for building dynamic analysis tools. There are Valgrind tools that can automatically detect many memory management and threading bugs, and profile your programs in detail. You can also use Valgrind to build new tools.</p>
<h3 id=pin>Pin</h3>
<p>Pin provides a rich API that abstracts away the underlying instruction-set and allows context information such as register contents to be passed to the injected code as parameters. Pin automatically saves and restores the registers that are overwritten by the injected code so the application continues to work. Limited access to symbol and debug information is available as well. The Pin framework download comes with a set of pre-created tools called ‘Pintools’.</p>
<p>pin in windows:</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>pin.bat -t pintool.dll [pintool args] -- program.exe [program args]
pin.bat -pid &lt;program pid&gt; -t pintool.dll [pintool args]
</code></pre></td></tr></table>
</div>
</div><p>Pin works in a very sophisticated way. The description in the Pin manuals to think of Pin as a JIT (just in time) compiler, where the compiler does not take byte code (as JIT compilation does with Java), but the executable of the process pin is executed against. This means pin inserts itself into the process’ execution. This can be seen when looking at the memory map of such a process:</p>
<h3 id=pinatrace>pinatrace</h3>
<p>One of Pin&rsquo;s biggest tools is its Memory Reference Trace. The pinatrace tool basically generates a file with every single memory access of a process. This allows you to get an understanding what happens within a function. This means you can determine what information or data is accessed in what function</p>
<h1 id=triton>Triton</h1>
<p>We&rsquo;ve talked enough about DBI and their entire ecosystem. Now let&rsquo;s talk about the tools built with them. I picked my favorite one to talk about</p>
<ul>
<li>Triton (Linux, Windows, Mac)</li>
</ul>
<p><a href=http://triton.quarkslab.com/ target=_blank rel="noopener noreffer">Triton</a> is a Dynamic Binary Analysis (DBA) framework. It provides internal components like a Dynamic Symbolic Execution (DSE) engine, a Taint Engine, AST representations of the x86 and the x86-64 instructions set semantics, SMT simplification passes, an SMT Solver Interface and, the last but not least, Python bindings.</p>
<p><img class=lazyload src=/svg/loading.min.svg data-src=https://camo.githubusercontent.com/d06dfe7f98f26fcddad3d29c7e65eab363d60bd2/687474703a2f2f747269746f6e2e717561726b736c61622e636f6d2f66696c65732f747269746f6e5f7630335f6172636869746563747572652e737667 data-srcset="https://camo.githubusercontent.com/d06dfe7f98f26fcddad3d29c7e65eab363d60bd2/687474703a2f2f747269746f6e2e717561726b736c61622e636f6d2f66696c65732f747269746f6e5f7630335f6172636869746563747572652e737667, https://camo.githubusercontent.com/d06dfe7f98f26fcddad3d29c7e65eab363d60bd2/687474703a2f2f747269746f6e2e717561726b736c61622e636f6d2f66696c65732f747269746f6e5f7630335f6172636869746563747572652e737667 1.5x, https://camo.githubusercontent.com/d06dfe7f98f26fcddad3d29c7e65eab363d60bd2/687474703a2f2f747269746f6e2e717561726b736c61622e636f6d2f66696c65732f747269746f6e5f7630335f6172636869746563747572652e737667 2x" data-sizes=auto alt=https://camo.githubusercontent.com/d06dfe7f98f26fcddad3d29c7e65eab363d60bd2/687474703a2f2f747269746f6e2e717561726b736c61622e636f6d2f66696c65732f747269746f6e5f7630335f6172636869746563747572652e737667 title=image></p>
<p>Based on these components, you are able to build program analysis tools, automate reverse engineering and perform software verification</p>
<p>As you can see, Triton supports all my mentioned DBIs and then some! It has provided a great and unified API to deal with Taint Analysis, and &lsquo;Symbolic Execution&rsquo;. I think Dynamic Symbolic execution needs its own blog post.</p>
<p>Note: This post will be edited soon because it&rsquo;s a very big topic :-)</p>
</div><div class=post-footer id=post-footer>
<div class=post-info>
<div class=post-info-line>
<div class=post-info-mod>
<span>Updated on 2018-03-27</span>
</div>
<div class=post-info-license></div>
</div>
<div class=post-info-line>
<div class=post-info-md></div>
<div class=post-info-share>
<span></span>
</div>
</div>
</div>
<div class=post-info-more>
<section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/linux/>linux</a>,&nbsp;<a href=/tags/reverse/>reverse</a>,&nbsp;<a href=/tags/binary-analysis/>binary analysis</a></section>
<section>
<span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span>
</section>
</div>
<div class=post-nav><a href=/2018/02/2018-02-20-portsharding/ class=prev rel=prev title="What is port sharding in Linux and why should I care"><i class="fas fa-angle-left fa-fw"></i>What is port sharding in Linux and why should I care</a>
<a href=/2018/05/2018-05-21-winbox-bug-dissection/ class=next rel=next title="Dissection of Winbox critical vulnerability">Dissection of Winbox critical vulnerability<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id=comments><div id=disqus_thread class=comment></div><noscript>
Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.
</noscript></div></article></div>
</main><footer class=footer>
<div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.87.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
</div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Ali Mosajjal</a></span></div>
</div>
</footer></div>
<div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top">
<i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments">
<i class="fas fa-comment fa-fw"></i>
</a>
</div><script type=text/javascript src=https://n0p-me.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},search:{highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-114664513-1',{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-114664513-1" async></script></body>
</html>